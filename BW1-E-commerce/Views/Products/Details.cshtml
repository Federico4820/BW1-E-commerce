@model ProductDetailModel

@{
	var productList = ViewBag.Prod as ProductListModel;
	ViewData["Title"] = "Pagina Dettagli";
}

@if (TempData["Error"] != null)
{
	<div class="alert alert-danger">
		@TempData["Error"]
	</div>
}
<div class="container-fluid">
	<nav aria-label="breadcrumb">
		<ol class="breadcrumb">
			<li class="breadcrumbCust-item"><a class="nav-link" asp-controller="Products" asp-action="Index">Home</a></li>
			<li class="breadcrumbCust-item"><span aria-hidden="true">›</span><a class="nav-link" asp-controller="Products" asp-action="Index">@Model.Category</a></li>
			<li class="breadcrumbCust-item active" aria-current="page" id="dataPage"><span aria-hidden="true">›</span>@Model.Name</li>
		</ol>
	</nav>
	<div class="row">
		@await Html.PartialAsync("_SidabarPartial")
		<div class=" col-sm-11  col-md-10">
			<section class="w-100 mb-5">
				<div class="containerShorter">
					<div class="imagesContainerIn">
						<div class="asideImgContainer d-flex flex-column">
							@foreach (var color in Model.Colors)
							{
								@foreach (var img in color.ImgListModel)
								{
									<div class="p-2 thumbnail" data-target="@img">
										<img src="@img" alt="Thumbnail">
									</div>
								}
							}
						</div>
						<div class="mainImgContainer">
							<div class="p-2">
								<img src="@Model.Colors[0].ImgListModel[0]" alt="Main Image" id="mainImg">
							</div>
						</div>
					</div>

					<div class="detailAside">
						<h2 class="prodTitle mb-2"> @Model.Name</h2>
						<p class="fw-bold">@Model.Price €</p>

						<div class="p-2 discountSpan mb-3 rounded-2">
							<i class="bi bi-tag"></i>
							<p>SEI NUOVO QUI? Ricevi il -10% su una selezione di stili! Con il codice: <strong>EPICODE</strong></p>
						</div>

						<p class="fw-bold">Colori disponibili</p>
						<div class="colorsContainer mb-3">
							@foreach (var color in Model.Colors)
							{
								<div class="@color.Name colors"></div>
							}
						</div>
						<div class="d-flex justify-content-between">
							<p class="fw-bold">Taglie disponibili</p>
							<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#sizeChart">
								Guida alle taglie
							</button>
							<div class="modal fade" id="sizeChart" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
								@await Html.PartialAsync("_TaglieDonna")
							</div>
						</div>

						<select class="mb-2">
							<option selected disabled>Seleziona un'opzione</option>
							@foreach (var item in Model.Sizes)
							{
								<option value="@item.IdSize">@item.Name</option>
							}
						</select>

						<div class="mb-3 d-flex align-items-center">
							<button class="btn btn-success btn-lg rounded-0 fw-bolder me-4 flex-grow-1">AGGIUNGI AL CARRELLO</button>
							<button class="favorite-detail">
								<i class="bi bi-heart"></i>
							</button>
						</div>


						<div class="borderCustom p-2 ps-3 mb-3">
							<div class="d-flex align-items-center">
								<i class="bi bi-truck"></i>
								<p class="p-0 m-0">Consegna gratuita sugli ordini idonei</p>
							</div>
							<div class="d-flex align-items-center">
								<i class="bi bi-box-seam"></i>
								<p class="p-0 m-0">Resi gratuiti</p>
							</div>
							<div class="">
								<a><p class="m-auto w-75">Guarda le nostre politiche sulle spedizione e dui resi</p></a>
							</div>

						</div>
						<div class="accordion">
							<div class="accordion-item">
								<h2 class="accordion-header">
									<button class="accordion-button fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
										Dettagli del prodotto
									</button>
								</h2>
								<div id="collapseOne" class="accordion-collapse collapse" data-bs-parent="#Detail">
									<ul class="accordion-body">
										@foreach (var detail in Model.Description)
										{
											<li class="ms-3">@detail</li>
										}
									</ul>
								</div>
							</div>
							<div class="accordion-item">
								<h2 class="accordion-header">
									<button class="accordion-button fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2" aria-expanded="false" aria-controls="collapseOne">
										Composizione
									</button>
								</h2>
								<div id="collapse2" class="accordion-collapse collapse" data-bs-parent="#Detail">
									<p class="ms-3">@string.Join(", ", Model.Materials.Select(detail => $"{detail.Percentage}% {detail.Name}")));</p>

								</div>
							</div>
						</div>

					</div>

				</div>


			</section>
			<section class="px-5">
				<h4>ALTRI CLIENTI HANNO ACQUISTATO ANCHE</h4>
				<div class="multiItemCustom d-flex justify-content-center">
					@await Html.PartialAsync("_MultiItemCarousel", Model.Category)
				</div>

			</section>
		</div>
	</div>
</div>

<script>
	document.addEventListener('DOMContentLoaded', function () {
		const thumbnails = document.querySelectorAll('.thumbnail');
		const mainImg = document.getElementById('mainImg');

		thumbnails.forEach(thumbnail => {
			thumbnail.addEventListener('click', function () {
				const targetImg = this.getAttribute('data-target');
				mainImg.setAttribute('src', targetImg);
				thumbnails.forEach(t => t.style.borderColor = 'transparent');
				this.style.borderColor = '#c0c0c0';
			});
		});
	});
</script>